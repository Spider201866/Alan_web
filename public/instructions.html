<!-- Alan UI - instructions.html | 18th June 2025, WJW -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Instructions for using Alan, the AI assistant for eyes, ears, and skin. Learn how to interact, what information to provide, and how to get the best results." />
    <title>Instructions</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="favicons/favicon-16x16.png" sizes="16x16">
    <link rel="apple-touch-icon" href="favicons/apple-touch-icon.png">
    <link rel="manifest" href="favicons/manifest.json">
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="faviconAndMeta.js"></script>
    <!-- Translations object embedded -->
    <script>
      window.translations = {
        en: {
          instructionsPageTitle: 'Instructions',
          instructionsIntro: `Alan is an AI assistant for students and those who only occasionally see eye, ear or skin cases. Write or speak clearly and avoid identifying names or details. Look fully around head/face/body part and examine both eyes/ears. Good luck!`,
          instructionsPatientPrompt: `Tell Alan about your patient's:`,
          // These are the base texts. Detail3 will be overridden dynamically.
          instructionsPatientDetail1: 'problem & onset',
          instructionsPatientDetail2: 'what you see',
          instructionsPatientDetail3: 'vision & pupils', // This is the default for Eye
          instructionsPatientDetail4: 'age, sex, medication',
          
          // Specific texts for patientDetail3 for Ear and Skin
          instructionsPatientDetail3_ear_specific: 'hearing',
          instructionsPatientDetail3_skin_specific: 'odour',

          instructionsBackground_eye: '#dfe7ff',
          instructionsBackground_ear: '#ffefd5',
          instructionsBackground_skin: '#e0ffff',
          instructionsUseArclight_eye: `<strong>Use Arclight:</strong> <strong><em>front, fundal reflex, back of eye.</em></strong>`,
          instructionsUseArclight_ear: `<strong>Use Arclight:</strong> <strong><em>canal, eardrum.</em></strong>`,
          instructionsUseArclight_skin: `<strong>Use Arclight:</strong> <strong><em>UV light, dermoscopy.</em></strong>`,
          instructionsLabelTooLittle: 'Too little',
          instructionsLabelJustRight: 'Just right',
          instructionsLabelTooMuch: 'Too much',
          instructionsTooLittle_eye: 'man red eye what?',
          instructionsJustRight_eye: `Man 25yr, red eye 3 day. No meds or eye prob before. Pain, watering, White cornea dot. Pupils OK, Vision 6/12 6/6 other`,
          instructionsTooMuch_eye: `This man came into clinics today. He drove into the building with a red eye, now he thinks the food he ate is affecting his eye. I see watering, red edges, you know? He wants help. Tall man, watery eyes, worried about cornea and pain. He says, "What is this?"`,
          instructionsAdditionalQuery_eye: `Alan also answers eye teaching/learning queries: What is Iritis? How do I see the retina?`,
          instructionsTooLittle_ear: 'child ear pain',
          instructionsJustRight_ear: 'Girl 4yr, R ear pain 2 days. Fever, pulling ear. TM red, bulging. Not crying now. No discharge.',
          instructionsTooMuch_ear: `My daughter has an earache, she was fine yesterday but today she keeps touching her right ear and she had a temperature earlier. I looked inside but I can't see anything. What do you think is wrong with her?`,
          instructionsAdditionalQuery_ear: 'Alan also answers ear teaching/learning queries: What is otitis media?',
          instructionsTooLittle_skin: 'rash on arm',
          instructionsJustRight_skin: `Woman 30yr, itchy rash on arm 1 week. Spreading slowly. Annular lesion with central clearing. No fever, feels well.`,
          instructionsTooMuch_skin: `I have this weird circular rash on my forearm, it started small but it's getting bigger. It doesn't hurt but it's really itchy. I haven't used any new soaps or anything. It's been there for about a week.`,
          instructionsAdditionalQuery_skin: `Alan also answers skin teaching/learning queries: What is tinea? How to use a Woods light?`,
        },
      };
    </script>
    <style>
      /* --- Identical to original styles, with flexbox fix & overflow --- */
      body, html {
        margin: 0; padding: 0; height: 100%;
        font-family: 'Calibri Light', Arial, sans-serif;
        font-size: 15px; background-color: white;
      }
      body {
        display: flex;
        flex-direction: column;
      }
      #content {
        padding: 8px 20px 20px 20px;
      }
      #wrapSection {
        overflow: hidden; margin-bottom: 25px; padding-right: 0;
      }
      #switchContainer {
        float: right; width: 100px; text-align: center;
        padding: 10px; border-radius: 15px;
        margin-left: 0; margin-right: -25px; margin-top: -10px;
      }
      .switch {
        position: relative; display: inline-block;
        width: 60px; height: 180px;
      }
      .switch input { display: none; }
      .switch-label {
        display: flex; align-items: center; justify-content: center;
        cursor: pointer; width: 60px; height: 60px;
        font-weight: bold; color: black; background-color: white;
        transition: background-color 0.3s, box-shadow 0.3s;
        border-radius: 20px; border: 1px solid black;
        margin-bottom: 10px; white-space: nowrap;
        overflow: hidden; text-overflow: ellipsis;
      }
      .switch-label:hover {
        background-color: #e0e0e0; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
      }
      .switch input:checked + .switch-label {
        background-color: black; color: white;
        border-color: black; box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
      }
      .clear { clear: both; }
      .boldText { font-weight: bold; }
      .justify { text-align: justify; }
      #additionalExamples p { margin-bottom: 10px; font-size: 13px; color: #333; }
      #additionalExamples strong {
        display: block; font-weight: bold;
        margin-bottom: -10px; line-height: 1.2;
      }
      #additionalExamples span {
        display: block; margin-left: 10px;
        margin-top: 0; line-height: 1.2;
      }
      .infoText { padding-left: 60px; color: black; margin-top: 5px; margin-bottom: 10px;}
      .infoText li { list-style-type: none; line-height: 1.2; margin-bottom: 2px; }
      .listText { color: red; }
      hr { border: none; height: 2px; background-color: #ccc; margin: 20px 0; }
      #useArclight { margin-top: 10px; margin-bottom: 10px; }
      #additionalQuery { padding-top: 5px; color: blue; font-size: 15px; }
      @media (max-width: 600px) {
        #switchContainer {
          width: 80px; margin-left: 0; margin-right: 0; margin-top: -10px;
        }
        .infoText { padding-left: 20px; }
      }
    </style>
  </head>
  <body>
    <main id="content">
      <p id="introText"></p>
      <div id="wrapSection">
        <div id="switchContainer">
          <div class="switch">
            <input type="radio" name="option" id="optionEye" value="eye" checked />
            <label for="optionEye" class="switch-label" title="Eye">Eye</label>
            <input type="radio" name="option" id="optionEar" value="ear" />
            <label for="optionEar" class="switch-label" title="Ear">Ear</label>
            <input type="radio" name="option" id="optionSkin" value="skin" />
            <label for="optionSkin" class="switch-label" title="Skin">Skin</label>
          </div>
        </div>
        <div id="wrapText">
          <p id="patientPrompt" class="boldText"></p>
          <ul class="infoText">
            <li id="patientDetail1"></li>
            <li id="patientDetail2"></li>
            <li id="patientDetail3"></li>
            <li id="patientDetail4"></li>
          </ul>
          <p id="useArclight"></p>
          <hr />
          <div id="additionalExamples" class="justify">
            <p><strong id="labelTooLittle"></strong><br /><span id="tooLittle"></span></p>
            <p><strong id="labelJustRight"></strong><br /><span id="justRight"></span></p>
            <p><strong id="labelTooMuch"></strong><br /><span id="tooMuch"></span></p>
            <p id="additionalQuery"></p>
          </div>
        </div>
        <div class="clear"></div>
      </div>
    </main>

    <script type="module">
      import { initPage } from './page-template.js';

      function applyTranslationsAndToggle() {
        var trans;
        var lang = localStorage.getItem('preferredLanguage') || 'en';
        trans = window.translations && window.translations[lang];
        if (trans) {
          document.getElementById('pageTitle').textContent = trans.instructionsPageTitle;
          document.getElementById('introText').innerHTML = trans.instructionsIntro;
          document.getElementById('patientPrompt').textContent = trans.instructionsPatientPrompt;
          
          // Set static details (1, 2, and 4)
          document.getElementById('patientDetail1').innerHTML = `<span class="listText">${trans.instructionsPatientDetail1}</span>`;
          document.getElementById('patientDetail2').innerHTML = `<span class="listText">${trans.instructionsPatientDetail2}</span>`;
          document.getElementById('patientDetail4').innerHTML = `<span class="listText">${trans.instructionsPatientDetail4}</span>`;
          
          // Detail 3 will be set by toggleContent based on the current selection
          toggleContent(); 
        } else {
          console.error("Translations not found for language:", lang);
        }

        document.querySelectorAll('input[name="option"]').forEach(function(radio) {
          radio.addEventListener('change', toggleContent);
        });

        function toggleContent() {
          var option = document.querySelector('input[name="option"]:checked').value;
          
          if (!trans) {
              console.warn("toggleContent called before translations (trans) are loaded.");
              var lang = localStorage.getItem('preferredLanguage') || 'en';
              trans = window.translations && window.translations[lang];
              if (!trans) {
                  console.error("Failed to load translations in toggleContent. Aborting.");
                  return; 
              }
          }

          document.getElementById('labelTooLittle').textContent = trans.instructionsLabelTooLittle;
          document.getElementById('labelJustRight').textContent = trans.instructionsLabelJustRight;
          document.getElementById('labelTooMuch').textContent = trans.instructionsLabelTooMuch;

          let patientDetail3Text = trans.instructionsPatientDetail3; // Default for Eye

          if (option === 'eye') {
            document.getElementById('content').style.backgroundColor = trans.instructionsBackground_eye;
            document.getElementById('useArclight').innerHTML = trans.instructionsUseArclight_eye;
            document.getElementById('tooLittle').textContent = trans.instructionsTooLittle_eye;
            document.getElementById('justRight').textContent = trans.instructionsJustRight_eye;
            document.getElementById('tooMuch').textContent = trans.instructionsTooMuch_eye;
            document.getElementById('additionalQuery').innerHTML = trans.instructionsAdditionalQuery_eye;
            // patientDetail3Text is already set to the default (eye version)
          } else if (option === 'ear') {
            document.getElementById('content').style.backgroundColor = trans.instructionsBackground_ear;
            document.getElementById('useArclight').innerHTML = trans.instructionsUseArclight_ear;
            document.getElementById('tooLittle').textContent = trans.instructionsTooLittle_ear;
            document.getElementById('justRight').textContent = trans.instructionsJustRight_ear;
            document.getElementById('tooMuch').textContent = trans.instructionsTooMuch_ear;
            document.getElementById('additionalQuery').innerHTML = trans.instructionsAdditionalQuery_ear;
            patientDetail3Text = trans.instructionsPatientDetail3_ear_specific; // Use specific ear text
          } else if (option === 'skin') {
            document.getElementById('content').style.backgroundColor = trans.instructionsBackground_skin;
            document.getElementById('useArclight').innerHTML = trans.instructionsUseArclight_skin;
            document.getElementById('tooLittle').textContent = trans.instructionsTooLittle_skin;
            document.getElementById('justRight').textContent = trans.instructionsJustRight_skin;
            document.getElementById('tooMuch').textContent = trans.instructionsTooMuch_skin;
            document.getElementById('additionalQuery').innerHTML = trans.instructionsAdditionalQuery_skin;
            patientDetail3Text = trans.instructionsPatientDetail3_skin_specific; // Use specific skin text
          }

          // Update patientDetail3 with the determined text
          document.getElementById('patientDetail3').innerHTML = `<span class="listText">${patientDetail3Text}</span>`;
        }
      }

      // Initialize the page with its title and its specific translation/toggle function
      initPage('Instructions', applyTranslationsAndToggle);
    </script>
  </body>
</html>
