<!-- WJW 12/04/2024 -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Alan</title>

    <script type="module"> import { faviconAndMetaSetup } from './faviconAndMeta.js'; faviconAndMetaSetup();</script>

    <link rel="stylesheet" href="styles.css">
    <link rel="preload" href="atomsblue.jpg" as="image">


    <script type="module" src="closer.js"></script>
    
  </head>

  <body>
    <style>
      #mainContent { text-align: center; }
    </style>
    <div id="mainContent" class="hidden">
    </div>
    

    <div class="chatbot-header">
      <div class="flex-spacer"></div> <!-- Invisible spacer to balance the language selector -->
      <div>
          <div class="chatbot-title">
              <span class="red">Al</span><span class="white">an</span>
          </div>
          <div class="chatbot-subtitle">
              Eyes & Ears
          </div>
      </div>
      <div class="language-selector">
        <select class="language-dropdown">
          <option value="en">English</option>
          <option value="fr">Français</option>
          <option value="es">Español</option>
          <option value="pt">Português</option>
          <option value="ar">العربية</option> <!-- Arabic -->
          <option value="sw">Kiswahili</option> <!-- Swahili -->
          <option value="cy">Cymraeg</option> <!-- Welsh -->
          <option value="ny">Chichewa</option> <!-- For Malawi -->
          <option value="rw">Kinwanda</option> <!-- For Rwanda -->
          <option value="lg">Luganda</option> <!-- For Uganda -->
      </select>
      
      </div>
      <div class="flex-spacer"></div> <!-- Second spacer for symmetry; can be hidden if not needed -->
  </div>
  


  <div class="menu-icon">&#9776;</div> <!-- 3 lines Menu Icon -->
  <div class="side-menu" style="display: flex; flex-wrap: wrap; align-items: center;">
  
    <div style="display: flex; margin-bottom: 10px;">
      <div>
          <p id="instructions-label" class="button-label">Read me!</p>
          <button id="instructions-button" class="button red pulse">Instructions</button>
      </div>
      <div style="margin-left: 10px;">
          <p id="job-role-label" class="button-label">Choose</p>
          <button id="job-role-button" class="button red pulse">Job Role</button>
          <div id="job-role-dropdown" class="dropdown-content hidden">
              <a href="#" onclick="updateJobRole('Health worker')">Health worker</a>
              <a href="#" onclick="updateJobRole('Nurse')">Nurse</a>
              <a href="#" onclick="updateJobRole('Ophthalmic clinical officer')">Ophthalmic clinical officer</a>
              <a href="#" onclick="updateJobRole('Medical student')">Medical student</a>
              <a href="#" onclick="updateJobRole('General practitioner')">General practitioner</a>
              <a href="#" onclick="updateJobRole('Hospital doctor')">Hospital doctor</a>
              <a href="#" onclick="updateJobRole('Ophthalmologist')">Ophthalmologist</a>
              <a href="#" onclick="updateJobRole('Optometrist')">Optometrist</a>
              <a href="#" onclick="updateJobRole('Orthoptist')">Orthoptist</a>
              <a href="#" onclick="updateJobRole('ENT specialist')">ENT specialist</a>
              <a href="#" onclick="updateJobRole('Pharmacist')">Pharmacist</a>
              <a href="#" onclick="updateJobRole('Audiologist')">Audiologist</a>
              <a href="#" onclick="updateJobRole('Ear care practitioner')">Ear care practitioner</a>
            </div>
          </div>
      </div>
  
      <!-- Grouping Front of Eye, Fundal Reflex, and Back of Eye buttons for same line display -->
      <div style="display: flex; margin-bottom: 10px;"> <!-- Grouping container for eye-related buttons -->
        <button class="button" style="margin-right: 10px;" onclick="window.location.href='eye.html';">How to examine the Eye</button>

      </div>
  
      <div style="display: flex; margin-bottom: 10px;"> <!-- Grouping container for eye-related buttons -->
        <button class="button green" style="margin-right: 10px;" onclick="window.location.href='ear.html';">How to examine the Ear</button>
       </div>

      <!-- Grouping Videos, Atoms, Tools buttons for same line display -->
      <div style="display: flex; margin-bottom: 10px;"> <!-- Grouping container for informational buttons -->
        <a href="https://www.youtube.com/@arclightproject" style="text-decoration: none;">
          <button class="button grey" style="margin-right: 10px;">Videos</button>
      </a>      
      <button class="button grey" style="margin-right: 10px;" onclick="window.location.href='atoms.html';">Atoms</button>

          <button class="button grey">Tools</button>
      </div>
  
      <!-- Grouping Arclight Project and Web Links buttons for same line display -->
      <div style="display: flex; margin-bottom: 10px;"> <!-- Grouping container for project-related buttons -->
        <a href="https://medicine.st-andrews.ac.uk/arclight/" style="text-decoration: none;">
          <button class="button grey" style="margin-right: 10px;">Arclight Project</button>
      </a>
      
          <!-- Button to toggle the display of links -->
          <button class="button grey" onclick="window.location.href='weblinks.html';">Web Links</button>


<script>
function toggleLinks() {
    var linksDiv = document.getElementById('links');
    if (linksDiv.style.display === 'none') {
        linksDiv.style.display = 'block';
    } else {
        linksDiv.style.display = 'none';
    }
}
</script>

      </div>
  
      <!-- Assuming this is part of your existing HTML file -->
<button class="button grey" onclick="location.href='aboutalan.html';">About Alan</button>

  </div>
  
  
  


      <div class="content-wrapper" style="display: flex; flex-direction: column; justify-content: flex-start; min-height: 20vh; font-weight: bold;">
        <div class="logo-and-text-container" style="text-align: center; line-height: 1.0; padding-top: 20px;">
          <img src="./triangle.png" alt="Logo" id="logo-image" style="max-width: 100px; display: block; margin: 0 auto; margin-bottom: 5px;"> <!-- Adjust margin-bottom if necessary -->
          <p id="additional-text" class="grey-text" style="font-size: 15px; color: grey; margin-top: -5px;"> <!-- Adjust margin-top to reduce space -->
            <span id="good-history">Good History</span>  |  
            <span id="examine-well">Examine Well</span>  |  
            <span id="use-arclight">Use Arclight</span>
          </p>          
          <p id="sub-text" class="centered-content" style="font-size: 16px; color: black; font-weight: 900; padding-bottom: 5px;">How can I help you today?</p>
        </div>
      </div>      
           
</div>

    </div>
    <div class="chatbot-container">
      <flowise-fullchatbot></flowise-fullchatbot>
    </div>

    <div>     
      <!-- Condition name displayed here -->
      <div class="detected-condition"></div>
      
      <!-- Thumbnail image with onclick functionality for zoom -->
      <img id="condition-image" alt="" style="max-width: 100%; height: 120px; display: block; margin: 0 auto; cursor: pointer;" onclick="toggleZoom(this)" /> 
      <p id="condition-description"></p> <!-- Add this line -->
      <div class="chatbot-version">*Alan can make mistakes. Use clinical judgement. 4/24 <br>
      </div>
  </div>
  
  <script>
      function toggleZoom(image) {
          // Check if the image is already zoomed
          if (image.style.height === '200px') {
              // If not zoomed, enlarge to fit the screen
              image.style.height = 'auto'; // Reset height to auto for natural aspect ratio
              image.style.maxWidth = 'none'; // Allow image to exceed the max-width of 100%
              image.style.cursor = 'zoom-out'; // Change cursor for zoom-out
          } else {
              // If zoomed, revert to thumbnail size
              image.style.height = '200px'; // Thumbnail height
              image.style.maxWidth = '100%'; // Ensure image does not exceed container width
              image.style.cursor = 'zoom-in'; // Change cursor for zoom-in
          }
      }
  </script>
    
    <script type="module">  import { initChatbot } from './chatbot-module.js'; initChatbot();</script>

<script type="module" src="listener-module.js"></script>

<script type="module">
  import { translations } from './language.js';

  document.addEventListener('DOMContentLoaded', function() {
    const dropdown = document.querySelector('.language-dropdown');
    
    dropdown.addEventListener('change', function() {
      const lang = this.value;
      document.querySelector('.chatbot-subtitle').textContent = translations[lang].eyesEars;
      document.getElementById('good-history').textContent = translations[lang].goodHistory;
      document.getElementById('examine-well').textContent = translations[lang].examineWell;
      document.getElementById('use-arclight').textContent = translations[lang].useArclight;
      document.getElementById('sub-text').textContent = translations[lang].howCanIHelp;
      document.querySelector('.chatbot-version').textContent = translations[lang].alanMistakes;
    });
  });

  document.querySelector('.menu-icon').addEventListener('click', function() {
  var tray = document.querySelector('.side-menu');
  // Toggle the side menu visibility
  if (tray.style.left === '-370px' || tray.style.left === '') {
    tray.style.left = '0'; // Slide in
    this.classList.add('active'); // Add the 'active' class to change the icon color to black
  } else {
    tray.style.left = '-370px'; // Slide out
    this.classList.remove('active'); // Remove the 'active' class to revert the icon color back to white
  }
});
</script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      var jobRoleButton = document.getElementById("job-role-button");
      var jobRoleDropdown = document.getElementById("job-role-dropdown");
      var jobRoleLabel = document.getElementById("job-role-label");
      var instructionsButton = document.getElementById("instructions-button");
      var instructionsLabel = document.getElementById("instructions-label");
  
      // Restore state from localStorage
      if (localStorage.getItem("selectedJobRole")) {
          jobRoleButton.textContent = localStorage.getItem("selectedJobRole");
      }
      if (localStorage.getItem("instructionsClicked")) {
          instructionsButton.classList.remove("pulse");
          instructionsLabel.style.display = "none";
      }
      if (localStorage.getItem("jobRoleClicked")) {
          jobRoleButton.classList.remove("pulse");
          jobRoleLabel.style.display = "none";
      }
  
      // Event listeners for job role dropdown interactions
      jobRoleButton.addEventListener("click", function() {
          jobRoleDropdown.style.display = jobRoleDropdown.style.display === "block" ? "none" : "block";
          // Update UI and localStorage when clicked
          if (!localStorage.getItem("jobRoleClicked")) {
              jobRoleLabel.style.display = "none";
              this.classList.remove("pulse");
              localStorage.setItem("jobRoleClicked", true);
          }
      });
  
      // Set job role from dropdown
      Array.from(jobRoleDropdown.getElementsByTagName('a')).forEach(function(link) {
          link.onclick = function() {
              updateJobRole(this.textContent);
          }
      });
  
      // Event listener for instructions button
      instructionsButton.addEventListener("click", function() {
          if (!localStorage.getItem("instructionsClicked")) {
              instructionsLabel.style.display = "none";
              this.classList.remove("pulse");
              localStorage.setItem("instructionsClicked", true);
          }
          window.location.href = 'instructions.html'; // Redirect to instructions.html
      });
  
      // Handle clicking outside dropdowns to close them
      window.onclick = function(event) {
          if (!event.target.matches('#job-role-button')) {
              Array.from(document.getElementsByClassName("dropdown-content")).forEach(function(dropdown) {
                  if (dropdown.style.display === "block") {
                      dropdown.style.display = "none";
                  }
              });
          }
      };
  });
  
  // Update job role function
  function updateJobRole(role) {
      document.getElementById("job-role-button").textContent = role;
      document.getElementById("job-role-dropdown").style.display = "none";
      localStorage.setItem("selectedJobRole", role); // Save the selected job role to localStorage
  }
  </script>
  
  
  
  


  </body>
</html>